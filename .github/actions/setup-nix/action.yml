name: 'Setup Nix'
description: 'Install Nix with Cachix caching for XMTP'
inputs:
  github-token:
    description: 'GitHub token for Nix installation'
    required: true
  cachix-auth-token:
    description: 'Cachix auth token for xmtp cache'
    required: false
runs:
  using: 'composite'
  steps:
    - uses: cachix/install-nix-action@v31
      with:
        github_access_token: ${{ inputs.github-token }}
        extra_nix_config: |
          accept-flake-config = true
    - uses: cachix/cachix-action@v16
      if: ${{ inputs.cachix-auth-token != '' }}
      with:
        name: xmtp
        authToken: ${{ inputs.cachix-auth-token }}
    - uses: cachix/cachix-action@v16
      if: ${{ inputs.cachix-auth-token == '' }}
      with:
        name: xmtp
