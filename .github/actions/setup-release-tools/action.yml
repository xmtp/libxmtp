name: "Setup Release Tools"
description: "Install release tools and make xmtp-release available in PATH"
runs:
  using: "composite"
  steps:
    - uses: ./.github/actions/setup-node
    - name: Install release tools
      working-directory: dev/release-tools
      shell: bash
      run: yarn install
    - name: Add xmtp-release to PATH
      shell: bash
      run: |
        BIN_DIR="$RUNNER_TEMP/xmtp-release-bin"
        mkdir -p "$BIN_DIR"
        cat > "$BIN_DIR/xmtp-release" << 'WRAPPER'
        #!/usr/bin/env bash
        exec yarn --cwd "$GITHUB_WORKSPACE/dev/release-tools" cli "$@"
        WRAPPER
        chmod +x "$BIN_DIR/xmtp-release"
        echo "$BIN_DIR" >> "$GITHUB_PATH"
