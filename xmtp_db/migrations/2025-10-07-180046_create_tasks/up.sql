-- Your SQL goes here

create table "tasks" (
  -- Serial ID auto-generated by the DB
  id integer primary key autoincrement not null,
  -- ID of the message that originated the task
  originating_message_sequence_id bigint not null check (originating_message_sequence_id >= 0),
  originating_message_originator_id integer not null check (originating_message_originator_id >= 0),
  -- Timestamp of the task's creation
  created_at_ns bigint not null,
  -- Timestamp of the task's expiration
  expires_at_ns bigint not null,
  -- Number of attempts to execute the task it should be set to 1 initially
  attempts integer not null,
  -- Maximum number of attempts to execute the task
  max_attempts integer not null,
  -- Timestamp of the last attempt to execute the task
  last_attempted_at_ns bigint not null,
  -- Scaling factor between attempts
  backoff_scaling_factor real not null,
  -- Maximum duration to wait between attempts
  max_backoff_duration_ns bigint not null,
  -- Initial duration to wait between attempts
  initial_backoff_duration_ns bigint not null,
  -- Timestamp of the next attempt to execute the task
  next_attempt_at_ns bigint not null,
  -- Hash of the data to execute the task, required for deduplication
  data_hash blob unique not null,
  -- Data to execute the task - a serialized xmtp.mls.database.Task protobuf message
  "data" blob not null
);

